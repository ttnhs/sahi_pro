<!DOCTYPE>
<!--
/**
 * Copyright Tyto Software Pvt. Ltd.
 */
-->
<html>
<head><title>Sahi Controller</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<script>__sahiDebugStr__="";__sahiDebug__=function(s){__sahiDebugStr__+=(s+"\n");};</script>
<script type="text/javascript" src="/_s_/dyn/SessionState_domainfix/domainfix.js"></script>
<script>
function informOpen(){
    var ishttps = location.href.indexOf("https") == 0;
    var commonDomain = "sahi.example.com";
    try{
    	commonDomain = window.top.opener._sahi.commonDomain;
    }catch(e){}
    var href = (ishttps? "https" : "http")  +"://" + commonDomain + "/_s_/dyn/ControllerUI_opened";
    new Image(0,0).src = href;
    window.isWinOpen = true;
};
informOpen();
</script>
<script type="text/javascript" src="/_s_/spr/exception.js"></script>
<script type="text/javascript" src="/_s_/spr/controller7.js"></script>
<script type="text/javascript" src="/_s_/spr/util.js"></script>
<script type="text/javascript" src="/_s_/spr/cookie.js"></script>
<script type="text/javascript" src="/_s_/spr/suggest.js"></script>
<style>
body *{font-size: 8pt;font-family: verdana;}
body {margin: 8px;background-color: #ddd;margin-top:12px}
div.content{background-color: white;border: 1px solid gray;margin: 2px;}
.hiTab {
	border: 1px solid gray;
	border-bottom: 1px solid white;
	cursor: pointer;
	font-size: 10pt;
	padding: 5px 5px;
	padding-bottom: 2px;
	background-color:white;
	margin: 0px -1px;
}

.dimTab {
	border: 1px solid gray;
	border-bottom: 0px solid gray;
	border-left: 0px solid gray;
	cursor: pointer;
	font-size: 9pt;
	padding: 3px 5px;
}
.centpc{width:100%;}
.comment {color: darkred;font-weight: bolder;font-size: 10px;}
.comment0 {color: darkred;font-weight: bolder;font-size: 11px;}
.comment1 {color: darkred;font-weight: bolder;font-size: 14px;}
.button {width: 50px;}
a{color: blue;}
form{margin:0px;padding:0px;}
hr{line-height:2px;margin:5px;padding:0px;line-height:2px;}

.suggestDD{display:none;border:1px solid grey;}
.urlDD1{display:none;border:1px solid grey;}
.anchorOn{cursor:pointer; border:1px solid #ddd;border-top:1px solid black;border-left:1px solid black;padding:1px;position:relative;top:3px;}
.anchorOff{cursor:pointer;border:1px solid #ddd;border-bottom:1px solid black;border-right:1px solid black;padding:1px;position:relative;top:3px;}
.readonlyTA{background:url(/_s_/spr/images/sahi_pro_logo2.png) no-repeat bottom right #eee;height:52px;width:99%;border:1px solid #ccc;}
.editableTA{height:52px;width:99%;border:1px solid #ddd;}
.inputBox{width:275px}
</style>

<script src="ext/codemirror/lib/codemirror.js"></script>
<link rel="stylesheet" href="ext/codemirror/lib/codemirror.css">
<script src="ext/codemirror/mode/javascript/javascript.js"></script>
<script src="ext/codemirror/lib/util/simple-hint.js"></script>
<link rel="stylesheet" href="ext/codemirror/lib/util/simple-hint.css">
<script src="ext/codemirror/lib/util/javascript-hint.js"></script>
<script src="ext/codemirror/lib/util/foldcode.js"></script>
<link rel="stylesheet" href="ext/codemirror/theme/eclipse.css">
<link rel="stylesheet" href="ext/codemirror/theme/neat.css">
<script type="text/javascript" src="/_s_/spr/codemirror_wrapper.js"></script>


<style type="text/css">.CodeMirror{border:1px solid #ddd;} #wrap_taDebug .CodeMirror-scroll{height:52px;width:99%;} #wrap_taSteps .CodeMirror-scroll{height:139px;width:99%;} </style>

</head>
<body onload="pageOnLoad();" onresize="resizeTAs()" onclick="Suggest.hideAll()" onbeforeunload="pageUnLoad()">
<div style="float:right;padding-right:10px;">
Sahi Pro 4.6 (<script>document.write(getVersionDate());</script>) &nbsp; 
<!--<a href="http://sahi.co.in/w/paid-support" target="_blank">Support</a>-->
</div>
<div style="margin:5px 0px 0px 2px;padding-left:1px;">
<span style="border-left:1px solid gray" id="trecorder" class="hiTab" onclick="resizeTAs();recOnClick();">&nbsp;Record&nbsp;</span><span  id="tplay" class="dimTab" onclick="resizeTAs();playbackOnClick();">&nbsp;Playback&nbsp;</span><span  id="tclip" class="dimTab" onclick="resizeTAs();clipOnClick();">&nbsp;Clipboard&nbsp;</span><!-- changed name,and clipOnClick() --><span  id="tinfo" class="dimTab" onclick="resizeTAs();infoOnClick();">&nbsp;Info&nbsp;</span>
</div>
<div id="trecorderbox" style="display:none;padding:0px;">
<div class="content" style="padding:10px;">
<div class="comment0 centpc" style="margin-bottom: 5px;">
Enter a script name and click "Record" to start recording.<br>
Script will be generated in sahi/userdata/scripts directory.
</div>
<form name="recordstartform" style="margin:0px;">  
    <table>
        <tr>
            <td>Script Directory:</td>
            <td>
                <select id="recdir" name="dir" style="width:300px" onchange="setSelectedScriptDir(this.options[this.selectedIndex].value)">
                    <option value="../scripts">../scripts</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>Script Name:</td>
            <td>
            	<div style="float:right;margin:0px;">
                <input type="button" id="record" name="record" value="Record" onclick="onRecordStartFormSubmit(this)">
                <input type="button" value="Stop" onclick="stopRec()">
                </div>
                <input type="text" id="recfile" name="file" value="" style="width:175px">
            </td>
        </tr>
    </table>
</form>

<hr>

<div class="comment0 centpc">
Press CTRL key and hover mouse over any HTML element. 
</div>
<form name="currentForm">
<table>
    <tr>
        <td colspan="3" class="comment0"><br>
        </td>
    </tr>

    <tr>
        <td>Accessor: <table style="display:inline;" cellpadding=0 cellspacing=0>
            <tr>
            <td><img src="/_s_/spr/images/upArrow.png" onclick="callUp()" title="Identify parent"></td>
            <td><img src="/_s_/spr/images/downArrow.png" onclick="callDown()" title="Identify previous child"></td>	
            </tr>
            </table></td>
        <td>
            <input id="accessor" name="accessor" value="" style="width:255px"  autocomplete="off">
            
            <img src="/_s_/spr/images/anchor.png" onclick="setAnchor()" id="anchor" class="anchorOff">
            <select id="accessorDD" class="suggestDD"></select>
        </td>
        <td><input type="button" class="button" value=" Click " onclick=
                "demoClick()"></td>
    </tr>

    <script>
        var accessorSuggest = new Suggest($("accessor"), $("accessorDD"), "accessor");
        accessorSuggest.type = "api";
        accessorSuggest.getOptions = getAccessorProps;
        accessorSuggest.onchange = resetValue;
    </script>

    <tr>
        <td>Alternatives:</td>
        <td><select name="alternative" onchange="$('accessor').value=this.value;" class="inputBox"></select></td>
        <td><input type="button" class="button" value="Hilight" onclick=
                "demoHighlight()"></td>
    </tr>

    <tr>
        <td>Value:</td>
        <td><input id="elValue" name="elValue" value="" class="inputBox"></td>
        <td><input type="button" class="button" value="Set" onclick="demoSetValue()"></td>
    </tr>
    <tr>
        <td>Prefix:</td>
        <td><input name="winName" value="" class="inputBox"></td>
		<td><input type="button" class="button" value="Hover" onclick=
		                "demoHover()"></td>        
    </tr>
    
    <tr>

</table>
</form>  
<div style="padding-right:10px;">
<div style="float:left">
<input type="button" class="button" value="Assert" onclick="sahi().doAssert($('accessor').value, $('elValue').value)"/> 
<input type="button" style="width:100px;" value="List Properties " onclick="showProperties()">
</div>
<div style="float:right">
Other Actions:        
<select style="background-color:#F3F3EF; padding:1px; border:1px solid #003C74;" onchange="demoAction(this)">
	<option>-- Choose --</option>
	<option value="_doubleClick">Double Click</option>
	<option value="_rightClick">Right Click</option>
	<option value="_wait">Wait</option>
	<option value="comment1">Comment (//)</option>
	<option value="comment2">Comment (/**/)</option>
	<option value="svon">Strict Visibility On</option>
	<option value="svoff">Strict Visibility Off</option>
</select>&nbsp;
<a class='comment0' href='sahi_recorder_help.htm' target='_blank' title="Help">?</a>
</div>
<div style="clear:both"></div>
</div>
<br/>
<!-- 
<input type="button" class="button" value="Wait" onclick="addWait()"/> 
<input type="text" id="waitTime" name="waitTime" value="3000" size="6"> ms 
<input type="button" value="Comment" onclick="mark()"/> 
<input type="text" id="comment" name="comment" value="" style="width:150px;"/>
-->
<script>
var commands = [];
commands[commands.length] = "_mouseOver(<accessor>)";
commands[commands.length] = "_doubleClick(<accessor>)";
commands[commands.length] = "_rightClick(<accessor>)";

</script>

<hr>
<div style="float:left;padding-top:3px">APIs List:</div>
<div style="float:right;padding-right:2px;"> 
<input type="text" id="apiTextbox" autocomplete="off" style="width:350px;">
<select id="apiSelect" class="suggestDD" style="width:350px;"></select>

<script>
    var apiSuggest = new Suggest($("apiTextbox"), $("apiSelect"), "api", true);
    apiSuggest.getOptions = getAPIs;
    apiSuggest.onchange = setAPI;
    apiSuggest.suggestOnClick();
</script>
</div>
<div style="clear:both"></div>
</div>
<!-- Recorded Steps and Eval Expression -->
<div style="background-color:#ddd;">
	<div style="margin:10px 0px 0px 3px;">
	<span style="float:right;margin-right:10px;"><span id="coords"></span> &nbsp; <a href="" onclick="loadEditor();return false;" target="refactorWin">Script Editor</a></span>
	<span style="border-left:1px solid gray" id="teval" class="hiTab" onclick="resizeTAs();">&nbsp;Evaluate expression&nbsp;</span><span  id="tsteps" class="dimTab" onclick="resizeTAs();">&nbsp;Recorded steps&nbsp;</span>
	</div>
	<div id="tevalbox"  class="content" style="padding:3px;"><!--
	Evaluate expression: <a href="javascript:showHistory()">History</a>
	-->
	<input type="hidden" id="history" name="history">
	<span id="wrap_taDebug">
		<textarea name="debug" id="taDebug" class="editableTA" style="" spellcheck="false"></textarea><br/>
	</span>
	<a href="javascript:showHistory()" style="float:right;margin:3px 10px;">History</a>
	<input type="button" onclick="evaluateExpr(true)" value="Test --&gt; ">
	<input type="button" onclick="append()" value="Append to Script">
	<input type="button" onmousedown="demoHighlight2()" value="Highlight">
	<input type="button" onmousedown="demoClick2()" value="Click">
	<br/>
	<textarea name="result" id="taResult" class="readonlyTA" style="" spellcheck="false"></textarea>
	</div>
	<div id="tstepsbox" class="content" style="display:none;padding:3px;">
	<span id="wrap_taSteps">
		<textarea name="result" id="taSteps"  class="readonlyTA" spellcheck="false"></textarea>
	</span>
	</div>
</div>
<!-- End Recorded Steps and Eval Expression -->

</div>

<!-- END Record Tab -->

<div class="content" id="tplaybox" style="display:none;">
<div style="margin:6px;">
<table>
  <tr>
    <td>
      <div id="setfile">
       <form name="scriptfileform" style="margin:0px;">
          <table>
            <tr>
              <td colspan="2"><span class="comment0">Set script from file</span>: [<a href="javascript:byFile(false)">from url</a>]</td>
            </tr>
            <tr>
              <td>Script Directory: </td>
              <td>
                <select id="pbdir" name="dir" onchange="populateScripts(this.options[this.selectedIndex].value)" style="width:300px">
                  <option value="../scripts">../scripts</option>
                </select>
              </td>
            </tr>

            <tr>
              <td bgcolor="">File:</td>
              <td><!--<select name="file" style="width:300px" 
              	  onchange="setSelectedScript(this.options[this.selectedIndex].value)"></select>-->
              	  <input id="filebox" name="filebox" style="width:300px" autocomplete="off">
            	  <select id="fileboxDD" name="suggestScriptFile" class="suggestDD" style="width:300px"></select>
            	  <script>
            	  	attachSuggestionBox("filebox", "fileboxDD");
            	  </script>
              </td>  
            </tr>
            <tr>
              <td>Start URL:</td>
              <td><input type="text" id="script_starturl" name="starturl" value="" style="width:300px" onchange="saveURL(this.value)">
              <select id="urlDD1" class="suggestDD"></select>
              <!-- 
              <img src="/_s_/spr/images/delete2.png" style="margin:0px 0px 1px -25px;border:0px solid red;cursor:pointer;vertical-align:bottom;" alt="Clear" title="Clear" onclick="resetUrl()"/></td>
               -->
            </tr>

            <tr>
              <td><input type="button"  class="button" value="Set" onclick="onScriptFormSubmit(this)"></td>
              <td class="comment">Click 'Set', wait till page refreshes, then
                click 'Play'.</td>
            </tr>
          </table>
          <input type="hidden" name="manual" value="1">
        </form>
      </div>
    </td>
    <td>
      <div id="seturl" style="display:none">
        <form name="scripturlform"> 
          <table>
            <tr>
              <td colspan="2"><span class="comment0">Set script from url</span>: [<a href="javascript:byFile(true)">from file</a>]</td>
            </tr>
			<tr><td></td></tr>
            <tr>
              <td bgcolor="">Script:</td>
              <td><input type="text" id="url" name="url" size="50"></td>
            </tr>
			<tr><td></td></tr>
            <tr>
              <td>Start URL:</td>
              <td><input type="text" id="url_starturl" name="starturl" value="" size="50" onchange="saveURL(this.value)">
              <select id="urlDD2" class="suggestDD"></select></td>
            </tr>
			<tr><td></td></tr>
            <tr>
              <td><input type="button" value="Set" onclick="onScriptFormSubmit(this)"></td>
              <td class="comment">Click 'Set', wait till page refreshes, then
                click 'Play'.</td>
            </tr>
          </table>
          <input type="hidden" name="manual" value="1">
        </form>
      </div>
    </td>
  </tr>
</table>

<hr>
<table style="margin-left:5px;">
  <tr>
    <td>Replay:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=
        "comment">Set script above, before clicking on 'Play'.</span></td>
  </tr>

  <tr>
    <td bgcolor="">
      <form name="playform" action="/_s_/dyn/Player_start" onsubmit="play()" target="channel">
		Current Step:<span id="currentStep">0</span>&nbsp;&nbsp;&nbsp;&nbsp;
        Next Step: <input type="text" size="3" id="nextStep" name="nextStep" value="1">
        <div style="padding-top:10px;">
        <input class="button" type="button" value="Play" onclick="play()">
        <input class="button" type="button" value="Pause" onclick="pause()">
        <input class="button" type="button" value="Step" onclick="stepWisePlay()">
        <input class="button" type="button" value="Stop" onclick="stopPlay()">
        <input class="button" type="button" value="Reset" onclick="replay()">
        </div>
      </form>
    </td>
  </tr>
</table>

<hr>
<table>
  <tr>
    <td bgcolor="">
      <form name="logForm">Statements:<br>
        <textarea id="talogs" class="readonlyTA" name="logs" style="width:99%;height:230px;" spellcheck="false"></textarea></form>
  		<div style="margin:5px 0px 0px 0px">
  		&nbsp;
		View:&nbsp;&nbsp; <a href="/_s_/dyn/Player_currentScript/" target="_blank">Script</a>&nbsp;|&nbsp;
		<a href="/_s_/dyn/Player_currentParsedScript" target="_blank">Parsed Script</a>&nbsp;|&nbsp;
		<a href="/_s_/dyn/Player_currentBrowserScript" target="_blank">Browser Script</a>&nbsp;|&nbsp;
		<a href="/_s_/dyn/pro/DBReports" target="_blank">Logs</a>
		</div>
  	</td>
  </tr>
</table>
</div>
</div>

<!-- Clipboard starts -->
<div class="content" id="tclipbox" style="display:none;padding:10px;">
<textarea id="clipTextArea" style="overflow:auto;"></textarea>
</div> 
<!--Clipboard ends -->

<div class="content" id="tinfobox" style="display:none;"> 
<div id="infoDiv" style="height:480px;padding:10px;overflow-y:auto;">
<a href="http://sahi.co.in/" target="_blank"><img src="/_s_/spr/images/sahi_pro_logo2.png" style="border:0px;float:right;margin:5px 10px;"/></a>
<table>
	<tr><td class="comment1" colspan="3"><u>Sahi Pro 4.6</u><br></td></tr>
	<tr><td><b>Version</b></td><td>:&nbsp;</td><td><div id="sahiVersion">4.6</div></td></tr>
	<tr><td><b>Build</b></td><td>:&nbsp;</td><td><div id="sahiBuild"><script>document.write(getVersion());</script></div></td></tr>
	<tr><td class="comment" colspan="3">
	<a href="#" id="updatesahi" target="_blank" onclick="updateVersion();return false;">Check for updates</a>
	</td></tr>
</table>
<hr/>
<table>
	<tr><td class="comment1" colspan="3"><u>Browser</u><br></td></tr>
	<tr><td><b>UserAgent</b></td><td>:&nbsp;</td><td><div id="userAgent"></div></td></tr>
	<tr><td><b>Name</b></td><td>:&nbsp;</td><td><div id="browserName"></div></td></tr>
	<tr><td><b>Version</b></td><td>:&nbsp;</td><td><div id="browserVersion"></div></td></tr>
	<tr><td><b>Native XmlHTTPRequest</b></td><td>:&nbsp;</td><td><div id="xmlHttpRequest"></div></td></tr>
	<tr><td><b>Is Java enabled</b></td><td>:&nbsp;</td><td><div id="javaEnabled"></div></td></tr>
	<tr><td><b>Is cookie enabled</b></td><td>:&nbsp;</td><td><div id="cookieEnabled"></div>
	</td></tr>
</table>
<br><hr>
<table>
	<tr><td class="comment1" colspan="3"><u>Operating System</u><br></td></tr>
	<tr><td><b>Name</b></td><td>:&nbsp;</td><td><div id="osName"></div></td></tr>
	<tr><td><b>Version</b></td><td>:&nbsp;</td><td><div id="osVersion"></div></td></tr>
	<tr><td><b>Architecture</b></td><td>:&nbsp;</td><td><div id="osArchitecture"></div></td></tr>
	<tr><td><b>Is process list available</b></td><td>:&nbsp;</td><td><div id="isTasklistAvailable"></div></td></tr>
	<tr><td><b>Is CertUtil available</b></td><td>:&nbsp;</td><td><div id="isCertUtilAvailable"></div>
	</td></tr>
</table>
<br><hr> 
<table>
	<tr><td class="comment1" colspan="3"><u>Java</u><br></td></tr>
	<tr><td><b>Java Installed Directory</b></td><td>:&nbsp;</td><td><div id="javaDirectory"></div></td></tr>
	<tr><td><b>JRE Version</b></td><td>:&nbsp;</td><td><div id="javaVersion"></div></td></tr>
	<tr><td><b>Is keytool available</b></td><td>:&nbsp;</td><td><div id="isKeytoolAvailable"></div>
	</td></tr>
</table>
<br><hr>
</div>
</div>
<script type="text/javascript">
createCMEditor("taDebug", false);
//createCMEditor("taSteps", true);
</script>
<script>
var tabGroup = new TabGroup("tabGroup", ["tplay", "trecorder", "tinfo", "tclip"], "trecorder");
var tabGroup2 = new TabGroup("tabGroup2", ["teval", "tsteps"], "teval");

var urlSuggest = new Suggest(document.getElementById("script_starturl"), document.getElementById("urlDD1"), "script_starturl", true);
var urlSuggest2 = new Suggest(document.getElementById("url_starturl"), document.getElementById("urlDD2"), "url_starturl", true);
urlSuggest.getOptions = getURLs;
urlSuggest2.getOptions = getURLs;
</script>

</body>
</html>